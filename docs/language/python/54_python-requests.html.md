<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>Python requests 模块</title>
</head>
<body>
<div class="article-intro" id="content">
			
			<h1>Python requests 模块</h1>&#13;
&#13;
<p>Python requests 是一个常用的 HTTP 请求库，可以方便地向网站发送 HTTP 请求，并获取响应结果。</p><p>requests 模块比 <a href="/python3/python-urllib.html" rel="noopener" target="_blank">urllib</a> 模块更简洁。</p>&#13;
&#13;
<p>使用 requests 发送 HTTP 请求需要先导入 requests 模块：</p>&#13;
&#13;
<pre>import requests</pre>&#13;
<p>&#13;
导入后就可以发送 HTTP 请求，使用 requests 提供的方法向指定 URL 发送 HTTP 请求，例如：</p>&#13;
<div class="example"><h2 class="example">实例</h2> <div class="example_code">
<span style="color: #a50"># 导入 requests 包</span><br/>
<span style="color: Green;font-weight:bold;">import</span> requests<br/>
<br/>
<span style="color: #a50"># 发送请求</span><br/>
x <span style="color: Gray;">=</span> requests.<span style="color: #05a;">get</span><span style="color: Olive;">(</span><span style="color: #a11;">'https://www.runoob.com/'</span><span style="color: Olive;">)</span><br/>
<br/>
<span style="color: #a50"># 返回网页内容</span><br/>
<span style="color: Green;font-weight:bold;">print</span><span style="color: Olive;">(</span>x.<span style="color: #05a;">text</span><span style="color: Olive;">)</span><br/>
</div></div>&#13;
<p>每次调用 requests 请求之后，会返回一个 response 对象，该对象包含了具体的响应信息，如状态码、响应头、响应内容等： </p>&#13;
&#13;
<pre>print(response.status_code)  # 获取响应状态码&#13;
print(response.headers)  # 获取响应头&#13;
print(response.content)  # 获取响应内容</pre>&#13;
<p>更多响应信息如下：</p>&#13;
<table class="reference"> &#13;
    <tbody><tr>&#13;
      <th style="width:10%">属性或方法</th>&#13;
     &#13;
      <th>说明</th>  </tr>  &#13;
      <tr>&#13;
      <td>apparent_encoding</td>&#13;
       <td>编码方式</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>close()</td>&#13;
       <td>关闭与服务器的连接</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>content</td>&#13;
     <td>返回响应的内容，以字节为单位</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>cookies</td>&#13;
      <td>返回一个 CookieJar 对象，包含了从服务器发回的 cookie</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>elapsed</td>&#13;
       <td>返回一个 timedelta 对象，包含了从发送请求到响应到达之间经过的时间量，可以用于测试响应速度。比如 r.elapsed.microseconds 表示响应到达需要多少微秒。</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>encoding</td>&#13;
     <td>解码 r.text 的编码方式</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>headers</td>&#13;
      <td>返回响应头，字典格式</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>history</td>&#13;
      <td>返回包含请求历史的响应对象列表（url）</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>is_permanent_redirect</td>&#13;
       <td>如果响应是永久重定向的 url，则返回 True，否则返回 False</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>is_redirect</td>&#13;
      <td>如果响应被重定向，则返回 True，否则返回 False</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>iter_content()</td>&#13;
      <td>迭代响应</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>iter_lines()</td>&#13;
     <td>迭代响应的行</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>json()</td>&#13;
     <td>返回结果的 JSON 对象 (结果需要以 JSON 格式编写的，否则会引发错误)</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>links</td>&#13;
       <td>返回响应的解析头链接</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>next</td>&#13;
      <td>返回重定向链中下一个请求的 PreparedRequest 对象</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>ok</td>&#13;
       <td>检查 "status_code" 的值，如果小于400，则返回 True，如果不小于 400，则返回 False </td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>raise_for_status()</td>&#13;
       <td>如果发生错误，方法返回一个 HTTPError 对象</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>reason</td>&#13;
      <td>响应状态的描述，比如 "Not Found" 或 "OK"</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>request</td>&#13;
       <td>返回请求此响应的请求对象</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>status_code</td>&#13;
      <td>返回 http 的状态码，比如 404 和 200（200 是 OK，404 是 Not Found）</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>text</td>&#13;
      <td>返回响应的内容，unicode 类型数据</td>&#13;
      </tr>&#13;
      <tr>&#13;
      <td>url</td>&#13;
     <td>返回响应的 URL</td>&#13;
      </tr>&#13;
  &#13;
  </tbody></table>&#13;
&#13;
<div class="example"><h2 class="example">实例</h2> <div class="example_code">
<span style="color: #a50"># 导入 requests 包</span><br/>
<span style="color: Green;font-weight:bold;">import</span> requests<br/>
<br/>
<span style="color: #a50"># 发送请求</span><br/>
x <span style="color: Gray;">=</span> requests.<span style="color: #05a;">get</span><span style="color: Olive;">(</span><span style="color: #a11;">'https://www.runoob.com/'</span><span style="color: Olive;">)</span><br/>
<br/>
<span style="color: #a50"># 返回 http 的状态码</span><br/>
<span style="color: Green;font-weight:bold;">print</span><span style="color: Olive;">(</span>x.<span style="color: #05a;">status_code</span><span style="color: Olive;">)</span><br/>
<br/>
<span style="color: #a50"># 响应状态的描述</span><br/>
<span style="color: Green;font-weight:bold;">print</span><span style="color: Olive;">(</span>x.<span style="color: #05a;">reason</span><span style="color: Olive;">)</span><br/>
<br/>
<span style="color: #a50"># 返回编码</span><br/>
<span style="color: Green;font-weight:bold;">print</span><span style="color: Olive;">(</span>x.<span style="color: #05a;">apparent_encoding</span><span style="color: Olive;">)</span><br/>
</div></div>&#13;
<p>&#13;
输出结果如下：</p>&#13;
&#13;
<pre>200&#13;
OK&#13;
utf-8</pre>&#13;
<p>&#13;
请求 json 数据文件，返回 json 内容：</p>&#13;
&#13;
<div class="example"><h2 class="example">实例</h2> <div class="example_code">
<span style="color: #a50"># 导入 requests 包</span><br/>
<span style="color: Green;font-weight:bold;">import</span> requests<br/>
<br/>
<span style="color: #a50"># 发送请求</span><br/>
x <span style="color: Gray;">=</span> requests.<span style="color: #05a;">get</span><span style="color: Olive;">(</span><span style="color: #a11;">'https://www.runoob.com/try/ajax/json_demo.json'</span><span style="color: Olive;">)</span><br/>
<br/>
<span style="color: #a50"># 返回 json 数据</span><br/>
<span style="color: Green;font-weight:bold;">print</span><span style="color: Olive;">(</span>x.<span style="color: #05a;">json</span><span style="color: Olive;">(</span><span style="color: Olive;">)</span><span style="color: Olive;">)</span><br/>
</div></div>&#13;
<p>&#13;
输出结果如下：</p>&#13;
&#13;
<pre>{'name': '网站', 'num': 3, 'sites': [{'name': 'Google', 'info': ['Android', 'Google 搜索', 'Google 翻译']}, {'name': 'Runoob', 'info': ['菜鸟教程', '菜鸟工具', '菜鸟微信']}, {'name': 'Taobao', 'info': ['淘宝', '网购']}]}</pre>&#13;
&#13;
<hr/>&#13;
<h2>requests 方法</h2>&#13;
<p>requests 方法如下表：</p>&#13;
<table class="reference"> &#13;
  <tbody><tr>&#13;
    <th style="width:30%">方法</th>&#13;
    <th>描述</th>  </tr>  &#13;
    <tr>&#13;
    <td>delete(<em>url</em>, <em>args</em>)</td>&#13;
    <td>发送 DELETE 请求到指定 url</td>&#13;
    </tr>&#13;
    <tr>&#13;
    <td>get(<em>url</em>, <em>params, args</em>)</td>&#13;
    <td>发送 GET 请求到指定 url</td>&#13;
    </tr>&#13;
    <tr>&#13;
    <td>head(<em>url</em>, <em>args</em>)</td>&#13;
    <td>发送 HEAD 请求到指定 url</td>&#13;
    </tr>&#13;
    <tr>&#13;
    <td>patch(<em>url</em>, <em>data, args</em>)</td>&#13;
    <td>发送 PATCH 请求到指定 url</td>&#13;
    </tr>&#13;
    <tr>&#13;
    <td>post(<em>url</em>, <em>data, json, args</em>)</td>&#13;
    <td>发送 POST 请求到指定 url</td>&#13;
    </tr>&#13;
    <tr>&#13;
    <td>put(<em>url</em>, <em>data, args</em>)</td>&#13;
    <td>发送 PUT 请求到指定 url</td>&#13;
    </tr>&#13;
    <tr>&#13;
    <td>request(<em>method</em>, <em>url</em>, <em>args</em>)</td>&#13;
    <td>向指定的 url 发送指定的请求方法</td>&#13;
    </tr>&#13;
</tbody></table><p>&#13;
使用 requests.request() 发送 get 请求：</p>&#13;
<div class="example"><h2 class="example">实例</h2> <div class="example_code">
<span style="color: #a50"># 导入 requests 包</span><br/>
<span style="color: Green;font-weight:bold;">import</span> requests<br/>
<br/>
<span style="color: #a50"># 发送请求</span><br/>
x <span style="color: Gray;">=</span> requests.<span style="color: #05a;">request</span><span style="color: Olive;">(</span><span style="color: #a11;">'get'</span><span style="color: Gray;">,</span> <span style="color: #a11;">'https://www.runoob.com/'</span><span style="color: Olive;">)</span><br/>
<br/>
<span style="color: #a50"># 返回网页内容</span><br/>
<span style="color: Green;font-weight:bold;">print</span><span style="color: Olive;">(</span>x.<span style="color: #05a;">status_code</span><span style="color: Olive;">)</span><br/>
</div></div><p>&#13;
输出结果如下：</p>&#13;
<pre>200</pre>&#13;
&#13;
<p>设置请求头：</p>&#13;
&#13;
<div class="example"><h2 class="example">实例</h2> <div class="example_code">
<span style="color: #a50"># 导入 requests 包</span><br/>
<span style="color: Green;font-weight:bold;">import</span> requests<br/>
<br/>
 <br/>
kw <span style="color: Gray;">=</span> <span style="color: Olive;">{</span><span style="color: #a11;">'s'</span>:<span style="color: #a11;">'python 教程'</span><span style="color: Olive;">}</span><br/>
<br/>
<span style="color: #a50"># 设置请求头</span><br/>
headers <span style="color: Gray;">=</span> <span style="color: Olive;">{</span><span style="color: #a11;">"User-Agent"</span>: <span style="color: #a11;">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36"</span><span style="color: Olive;">}</span><br/>
 <br/>
<span style="color: #a50"># params 接收一个字典或者字符串的查询参数，字典类型自动转换为url编码，不需要urlencode()</span><br/>
response <span style="color: Gray;">=</span> requests.<span style="color: #05a;">get</span><span style="color: Olive;">(</span><span style="color: #a11;">"https://www.runoob.com/"</span><span style="color: Gray;">,</span> params <span style="color: Gray;">=</span> kw<span style="color: Gray;">,</span> headers <span style="color: Gray;">=</span> headers<span style="color: Olive;">)</span><br/>
<br/>
<span style="color: #a50"># 查看响应状态码</span><br/>
<span style="color: Green;font-weight:bold;">print</span> <span style="color: Olive;">(</span>response.<span style="color: #05a;">status_code</span><span style="color: Olive;">)</span><br/>
<br/>
<span style="color: #a50"># 查看响应头部字符编码</span><br/>
<span style="color: Green;font-weight:bold;">print</span> <span style="color: Olive;">(</span>response.<span style="color: #05a;">encoding</span><span style="color: Olive;">)</span><br/>
<br/>
<span style="color: #a50"># 查看完整url地址</span><br/>
<span style="color: Green;font-weight:bold;">print</span> <span style="color: Olive;">(</span>response.<span style="color: #05a;">url</span><span style="color: Olive;">)</span><br/>
<br/>
<span style="color: #a50"># 查看响应内容，response.text 返回的是Unicode格式的数据</span><br/>
<span style="color: Green;font-weight:bold;">print</span><span style="color: Olive;">(</span>response.<span style="color: #05a;">text</span><span style="color: Olive;">)</span><br/>
<br/>
</div></div>&#13;
<p>&#13;
输出结果如下：</p>&#13;
&#13;
<pre>&#13;
200&#13;
UTF-8&#13;
https://www.runoob.com/?s=python+%E6%95%99%E7%A8%8B&#13;
&#13;
... 其他内容...&#13;
</pre><p>&#13;
post() 方法可以发送 POST 请求到指定 url，一般格式如下：</p>&#13;
&#13;
<pre>requests.post(url, data={key: value}, json={key: value}, args)</pre><ul>&#13;
<li>&#13;
<p>&#13;
<strong>url</strong> 请求 url。</p></li>&#13;
	<li>&#13;
<p>&#13;
<strong>data</strong> 参数为要发送到指定 url 的字典、元组列表、字节或文件对象。</p></li><li>&#13;
&#13;
<p>&#13;
<strong>json</strong> 参数为要发送到指定 url 的 JSON 对象。</p></li><li>&#13;
<p><strong>args</strong> 为其他参数，比如 cookies、headers、verify等。</p>&#13;
</li></ul>&#13;
&#13;
&#13;
&#13;
<div class="example"><h2 class="example">实例</h2> <div class="example_code">
<span style="color: #a50"># 导入 requests 包</span><br/>
<span style="color: Green;font-weight:bold;">import</span> requests<br/>
<br/>
<span style="color: #a50"># 发送请求</span><br/>
x <span style="color: Gray;">=</span> requests.<span style="color: #05a;">post</span><span style="color: Olive;">(</span><span style="color: #a11;">'https://www.runoob.com/try/ajax/demo_post.php'</span><span style="color: Olive;">)</span><br/>
<br/>
<span style="color: #a50"># 返回网页内容</span><br/>
<span style="color: Green;font-weight:bold;">print</span><span style="color: Olive;">(</span>x.<span style="color: #05a;">text</span><span style="color: Olive;">)</span><br/>
</div></div>&#13;
&#13;
<p>&#13;
输出结果如下：</p>&#13;
<pre>&lt;p style='color:red;'&gt;本内容是使用 POST 方法请求的。&lt;/p&gt;&lt;p style='color:red;'&gt;请求时间：&#13;
2022-05-26 17:30:47&lt;/p&gt;</pre>&#13;
<p>post 请求带参数：</p>&#13;
&#13;
<div class="example"><h2 class="example">实例</h2> <div class="example_code">
<span style="color: #a50"># 导入 requests 包</span><br/>
<span style="color: Green;font-weight:bold;">import</span> requests<br/>
<br/>
<span style="color: #a50"># 表单参数，参数名为 fname 和 lname</span><br/>
myobj <span style="color: Gray;">=</span> <span style="color: Olive;">{</span><span style="color: #a11;">'fname'</span>: <span style="color: #a11;">'RUNOOB'</span><span style="color: Gray;">,</span><span style="color: #a11;">'lname'</span>: <span style="color: #a11;">'Boy'</span><span style="color: Olive;">}</span><br/>
<br/>
<span style="color: #a50"># 发送请求</span><br/>
x <span style="color: Gray;">=</span> requests.<span style="color: #05a;">post</span><span style="color: Olive;">(</span><span style="color: #a11;">'https://www.runoob.com/try/ajax/demo_post2.php'</span><span style="color: Gray;">,</span> data <span style="color: Gray;">=</span> myobj<span style="color: Olive;">)</span><br/>
<br/>
<span style="color: #a50"># 返回网页内容</span><br/>
<span style="color: Green;font-weight:bold;">print</span><span style="color: Olive;">(</span>x.<span style="color: #05a;">text</span><span style="color: Olive;">)</span><br/>
</div></div>&#13;
&#13;
<p>&#13;
输出结果如下：</p>&#13;
<pre>&lt;p style='color:red;'&gt;你好，RUNOOB Boy，今天过得怎么样？&lt;/p&gt;</pre>&#13;
<hr/>&#13;
<h2>附加请求参数</h2>&#13;
<p>发送请求我们可以在请求中附加额外的参数，例如请求头、查询参数、请求体等，例如：</p>&#13;
&#13;
<pre>headers = {'User-Agent': 'Mozilla/5.0'}  # 设置请求头&#13;
params = {'key1': 'value1', 'key2': 'value2'}  # 设置查询参数&#13;
data = {'username': 'example', 'password': '123456'}  # 设置请求体&#13;
response = requests.post('https://www.runoob.com', headers=headers, params=params, data=data)</pre>&#13;
<p>上述代码发送一个 POST 请求，并附加了请求头、查询参数和请求体。</p>&#13;
<p>&#13;
除了基本的 GET 和 POST 请求外，requests 还支持其他 HTTP 方法，如 PUT、DELETE、HEAD、OPTIONS 等。</p>			<!-- 其他扩展 -->
						
			</div>
			
		
</body>
</html>